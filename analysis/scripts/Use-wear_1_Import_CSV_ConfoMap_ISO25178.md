Import CSV from ConfoMap ISO25178 - use-wear archaeology & experiments
================
Lisa Schunk
2021-01-27 10:20:41

  - [Goal of the script](#goal-of-the-script)
  - [Load packages](#load-packages)
  - [Get names, path and information of all
    files](#get-names-path-and-information-of-all-files)
  - [Read in original CSV-files](#read-in-original-csv-files)
  - [Add columns with further
    information](#add-columns-with-further-information)
  - [Keeps only interesting columns and orders
    them](#keeps-only-interesting-columns-and-orders-them)
  - [Merge three datasets](#merge-three-datasets)
  - [Save data](#save-data)
      - [Format name of output file](#format-name-of-output-file)
      - [Write to XLSX](#write-to-xlsx)
      - [Save R object](#save-r-object)
      - [Show files information](#show-files-information)
  - [sessionInfo() and RStudio
    version](#sessioninfo-and-rstudio-version)

-----

# Goal of the script

This script formats the output resulting from applying a template
computing ISO25178 parameters in ConfoMap. The script will:

1.  Read in the original Rbin-files
2.  Format the data in order to make the three data sets fitting  
3.  Write an XLSX-file and save an R object ready for further analysis
    in R

<!-- end list -->

``` r
dir_in <- "analysis/raw_data"
dir_out <- "analysis/derived_data/"
```

Raw data must be located in \~/analysis/raw\_data.  
Formatted data will be saved in \~/analysis/derived\_data/.

The knit directory for this script is the project directory.

-----

# Load packages

``` r
library(openxlsx)
library(tools)
library(R.utils)
library(chron)
library(tidyverse)
```

-----

# Get names, path and information of all files

``` r
data_files <- list.files(dir_in, pattern = "\\.Rbin$", full.names = TRUE)
md5_in <- md5sum(data_files)
info_in <- data.frame(files = basename(names(md5_in)), checksum = md5_in, 
                      row.names = NULL)
```

The checksum (MD5 hashes) of the imported files are:

``` 
               files                         checksum
1 AvsN_use-wear.Rbin 0bbb6fa72fc579f481ad716752f28d5d
2  TFE_use-wear.Rbin 433a3db62e03eee5450b37da5616b1a7
3      Use-wear.Rbin 2b7acbe46dcf8faa0145bc7f141abc26
```

-----

# Read in original CSV-files

``` r
# data from 'aVSn' experiment, tool function experiment and archaeology 
AvsN_imp <- loadObject(data_files[1])
str(AvsN_imp)
```

    'data.frame':   60 obs. of  55 variables:
     $ Sample                  : chr  "FLT4-12" "FLT4-12" "FLT4-12" "FLT4-12" ...
     $ Cycle                   : Factor w/ 2 levels "before","2000": 1 1 1 2 2 2 1 1 1 1 ...
     $ Location                : chr  "B1" "B1" "B1" "B1" ...
     $ Area                    : chr  "01" "01" "01" "01" ...
     $ Spot                    : chr  "a" "b" "c" "a" ...
     $ Objective               : Factor w/ 2 levels "50x075","50x095": 2 2 2 2 2 2 1 1 1 1 ...
     $ Raw.material            : Factor w/ 2 levels "flint","lydite": 1 1 1 1 1 1 1 1 1 1 ...
     $ Contact.material        : chr  "skin pad" "skin pad" "skin pad" "skin pad" ...
     $ Analysis.date           : Date, format: "2020-08-17" "2020-08-17" ...
     $ Analysis.time           : 'times' num  14:48:58 14:49:34 14:50:09 14:50:43 14:51:18 ...
      ..- attr(*, "format")= chr "h:m:s"
     $ Acquisition.date.time   : chr  "7/20/2020 2:39:46 PM" "7/20/2020 2:55:08 PM" "7/20/2020 3:12:51 PM" "7/20/2020 3:29:51 PM" ...
     $ Axis.length.X           : num  255 255 255 255 255 ...
     $ Axis.size.X             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.X          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Y           : num  255 255 255 255 255 ...
     $ Axis.size.Y             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.Y          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Z           : num  27287 27231 26655 13395 13291 ...
     $ Axis.size.Z             : num  63694 65201 63762 65466 65538 ...
     $ Axis.spacing.Z          : num  0.428 0.418 0.418 0.205 0.203 ...
     $ NM.points.ratio.Z       : num  0 0 0 0 0 0 0 0 0 0 ...
     $ Sq                      : num  160 151 196 227 160 ...
     $ Ssk                     : num  -0.0199 4.1704 2.0253 2.2084 2.0238 ...
     $ Sku                     : num  6.21 37.01 10.42 11.22 9.9 ...
     $ Sp                      : num  1153 1693 1606 1740 1174 ...
     $ Sv                      : num  716 594 406 473 321 ...
     $ Sz                      : num  1870 2286 2013 2212 1496 ...
     $ Sa                      : num  115.8 84.7 138.7 154.4 111.9 ...
     $ Smr                     : num  12.722 0.832 1.59 1.645 10.656 ...
     $ Smc                     : num  177 111 232 250 184 ...
     $ Sxp                     : num  362 192 211 245 175 ...
     $ Sal                     : num  5.94 7.73 8.18 12.2 8.71 ...
     $ Str                     : num  0.0746 0.669 0.226 0.6994 0.1989 ...
     $ Std                     : num  170 133 50.5 101 81.5 ...
     $ Sdq                     : num  0.1019 0.0833 0.1177 0.1378 0.1048 ...
     $ Sdr                     : num  0.513 0.337 0.68 0.916 0.54 ...
     $ Vm                      : num  0.0103 0.0176 0.0206 0.0263 0.0175 ...
     $ Vv                      : num  0.187 0.128 0.252 0.276 0.202 ...
     $ Vmp                     : num  0.0103 0.0176 0.0206 0.0263 0.0175 ...
     $ Vmc                     : num  0.119 0.073 0.133 0.143 0.106 ...
     $ Vvc                     : num  0.164 0.115 0.241 0.262 0.192 ...
     $ Vvv                     : num  0.0233 0.0128 0.0112 0.0138 0.0092 ...
     $ Maximum.depth.of.furrows: num  905 865 814 881 640 ...
     $ Mean.depth.of.furrows   : num  257 174 386 409 311 ...
     $ Mean.density.of.furrows : num  3081 3318 3101 3225 3191 ...
     $ First.direction         : num  1.69e+02 1.35e+02 8.76e-03 9.00e+01 9.00e+01 ...
     $ Second.direction        : num  180 90 135 135 45 ...
     $ Third.direction         : num  135 45 117 116 135 ...
     $ Isotropy                : num  6.16 66.63 52.93 77.77 55.86 ...
     $ epLsar                  : num  0.00356 0.00393 0.00189 0.00195 0.00041 ...
     $ NewEplsar               : num  0.0187 0.0188 0.0179 0.0179 0.0175 ...
     $ Asfc                    : num  1.145 0.703 1.494 2.067 1.207 ...
     $ Smfc                    : num  3.08 3.3 2.88 2.52 2.52 ...
     $ HAsfc9                  : num  0.201 0.636 0.191 0.512 0.239 ...
     $ HAsfc81                 : num  0.264 0.939 0.388 0.722 0.386 ...
     - attr(*, "comment")= Named chr [1:44] "µm" "points" "µm" "µm" ...
      ..- attr(*, "names")= chr [1:44] "Axis length - X" "Axis size - X" "Axis spacing - X" "Axis length - Y" ...

``` r
TFE_imp <- loadObject(data_files[2])
str(TFE_imp)
```

    'data.frame':   24 obs. of  57 variables:
     $ Sample                  : chr  "FLT8-10" "FLT8-10" "FLT8-10" "FLT8-2" ...
     $ Cycle                   : chr  "2000" "2000" "2000" "2000" ...
     $ Location                : chr  "C1" "C1" "C1" "D1" ...
     $ Area                    : chr  "01" "01" "01" "01" ...
     $ Spot                    : chr  "a" "b" "c" "a" ...
     $ Objective               : chr  "50x095" "50x095" "50x095" "50x095" ...
     $ Raw.material            : Factor w/ 2 levels "flint","lydite": 1 1 1 1 1 1 1 1 1 1 ...
     $ Contact.material        : Factor w/ 1 level "bone plate": 1 1 1 1 1 1 1 1 1 1 ...
     $ Task                    : Factor w/ 2 levels "carving","cutting": 1 1 1 2 2 2 2 2 2 1 ...
     $ Edge.angle              : Factor w/ 2 levels "35°","45°": 2 2 2 2 2 2 1 1 1 1 ...
     $ Analysis.date           : Date, format: "2020-08-27" "2020-08-27" ...
     $ Analysis.time           : 'times' num  15:01:32 15:02:11 15:02:48 15:03:28 15:04:06 ...
      ..- attr(*, "format")= chr "h:m:s"
     $ Acquisition.date.time   : chr  "8/27/2020 11:10:06 AM" "8/27/2020 11:41:47 AM" "8/27/2020 11:54:14 AM" "8/26/2020 4:10:04 PM" ...
     $ Axis.length.X           : num  255 255 255 255 255 ...
     $ Axis.size.X             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.X          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Y           : num  255 255 255 255 255 ...
     $ Axis.size.Y             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.Y          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Z           : num  34010 95224 7771 60579 60641 ...
     $ Axis.size.Z             : num  73180 61441 61664 52314 57436 ...
     $ Axis.spacing.Z          : num  0.465 1.55 0.126 1.158 1.056 ...
     $ NM.points.ratio.Z       : num  0 0 0 0 0 0 0 0 0 0 ...
     $ Sq                      : num  1640 7217 315 2525 1718 ...
     $ Ssk                     : num  -0.626 0.517 -1.202 -0.51 -1.432 ...
     $ Sku                     : num  7.12 4.34 6.34 6.94 12.01 ...
     $ Sp                      : num  5603 24832 716 8900 5842 ...
     $ Sv                      : num  7354 24749 1929 12958 11581 ...
     $ Sz                      : num  12956 49581 2645 21858 17423 ...
     $ Sa                      : num  1080 5359 239 1814 1117 ...
     $ Smr                     : num  0.887 0.151 84.156 0.519 0.768 ...
     $ Smc                     : num  1669 8453 350 2620 1633 ...
     $ Sxp                     : num  4454 13827 770 5202 3974 ...
     $ Sal                     : num  19.3 18.3 11.3 20.1 17.7 ...
     $ Str                     : num  0.26 NA 0.286 NA 0.154 ...
     $ Std                     : num  159 169 156 148 148 ...
     $ Sdq                     : num  0.269 1.165 0.166 0.336 0.294 ...
     $ Sdr                     : num  3.01 19.2 1.35 4.62 3.61 ...
     $ Vm                      : num  0.1354 0.6714 0.0093 0.1819 0.1149 ...
     $ Vv                      : num  1.804 9.125 0.359 2.802 1.748 ...
     $ Vmp                     : num  0.1354 0.6714 0.0093 0.1819 0.1149 ...
     $ Vmc                     : num  0.928 5.19 0.266 1.856 1.034 ...
     $ Vvc                     : num  1.553 8.34 0.309 2.488 1.485 ...
     $ Vvv                     : num  0.2512 0.7845 0.0502 0.314 0.2637 ...
     $ Maximum.depth.of.furrows: num  7251 27509 2061 7182 6417 ...
     $ Mean.depth.of.furrows   : num  1161 8568 433 2115 1408 ...
     $ Mean.density.of.furrows : num  2724 2613 3036 2486 2519 ...
     $ First.direction         : num  90 169 90 135 135 ...
     $ Second.direction        : num  135 174 154 154 154 ...
     $ Third.direction         : num  0.0017 179.9953 135.0327 0.0028 161.4949 ...
     $ Isotropy                : num  18.3 NA 38.2 NA 35.8 ...
     $ epLsar                  : num  0.00234 0.00814 0.00109 0.00501 0.00521 ...
     $ NewEplsar               : num  0.0185 0.021 0.0178 0.0199 0.02 ...
     $ Asfc                    : num  4.31 37.84 2.9 5.11 4.67 ...
     $ Smfc                    : num  4.93 759.24 3.3 32.33 6.9 ...
     $ HAsfc9                  : num  0.6628 6.9889 0.0727 0.5633 0.4985 ...
     $ HAsfc81                 : num  0.708 6.728 0.198 1.53 1.352 ...
     - attr(*, "comment")= Named chr [1:44] "µm" "points" "µm" "µm" ...
      ..- attr(*, "names")= chr [1:44] "Axis length - X" "Axis size - X" "Axis spacing - X" "Axis length - Y" ...

``` r
Arch_imp <- loadObject(data_files[3])
str(Arch_imp)
```

    'data.frame':   150 obs. of  57 variables:
     $ Sample                  : chr  "MU-232" "MU-232" "MU-232" "MU-003" ...
     $ Site                    : Factor w/ 3 levels "Balve","Buhlen",..: 1 1 1 1 1 1 1 1 1 1 ...
     $ Tool.type               : Factor w/ 4 levels "Keilmesser","Pradnick scraper",..: 1 1 1 1 1 1 1 1 1 4 ...
     $ Raw.material            : Factor w/ 2 levels "flint","lydite": 2 2 2 2 2 2 2 2 2 2 ...
     $ Location                : chr  "B" "B" "B" "D" ...
     $ Sublocation             : chr  "2" "2" "2" "1" ...
     $ Area                    : chr  "01" "01" "01" "01" ...
     $ Spot                    : chr  "a" "b" "c" "a" ...
     $ Usewear.type            : Factor w/ 11 levels "A","B","B2","C",..: 9 9 9 2 2 2 4 4 4 3 ...
     $ Objective               : Factor w/ 3 levels "20x07","50x075",..: 1 1 1 3 3 3 2 2 2 3 ...
     $ Analysis.date           : Date, format: "2020-09-07" "2020-09-07" ...
     $ Analysis.time           : 'times' num  15:08:03 15:08:27 15:08:51 15:09:16 15:09:41 ...
      ..- attr(*, "format")= chr "h:m:s"
     $ Acquisition.date.time   : chr  "07.07.2020 16:58" "07.08.2020 10:35" "07.08.2020 12:10" "07.03.2020 10:44" ...
     $ Axis.length.X           : num  255 255 255 255 255 ...
     $ Axis.size.X             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.X          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Y           : num  255 255 255 255 255 ...
     $ Axis.size.Y             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.Y          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Z           : num  249564 99661 162726 38576 39610 ...
     $ Axis.size.Z             : num  65505 35461 32419 65340 66654 ...
     $ Axis.spacing.Z          : num  3.81 2.81 5.019 0.59 0.594 ...
     $ NM.points.ratio.Z       : num  0 0 0 0 0 0 0 0 0 0 ...
     $ Sq                      : num  3243 2493 4332 1912 1936 ...
     $ Ssk                     : num  0.0634 -0.9445 0.1816 -0.058 -0.2928 ...
     $ Sku                     : num  3.46 7.36 3.08 3.75 3.47 ...
     $ Sp                      : num  10477 7460 12748 6231 5796 ...
     $ Sv                      : num  10005 12962 16115 6843 6575 ...
     $ Sz                      : num  20482 20422 28864 13075 12371 ...
     $ Sa                      : num  2506 1813 3409 1464 1495 ...
     $ Smr                     : num  0.551 0.697 0.388 0.784 0.586 ...
     $ Smc                     : num  3754 2956 5778 2454 2429 ...
     $ Sxp                     : num  6582 4878 7854 3949 4400 ...
     $ Sal                     : num  25.9 20.5 23.4 24.4 24.9 ...
     $ Str                     : num  0.321 0.215 0.241 0.784 0.767 ...
     $ Std                     : num  42.5 93 51 103.7 106.7 ...
     $ Sdq                     : num  0.603 0.376 0.557 0.301 0.298 ...
     $ Sdr                     : num  9.99 5.11 10.54 4.13 4.09 ...
     $ Vm                      : num  0.2094 0.1157 0.2311 0.0944 0.0828 ...
     $ Vv                      : num  3.96 3.07 6.01 2.55 2.51 ...
     $ Vmp                     : num  0.2094 0.1157 0.2311 0.0944 0.0828 ...
     $ Vmc                     : num  2.78 1.82 3.63 1.59 1.6 ...
     $ Vvc                     : num  3.56 2.73 5.53 2.31 2.24 ...
     $ Vvv                     : num  0.403 0.342 0.48 0.238 0.275 ...
     $ Maximum.depth.of.furrows: num  12698 14381 16377 7155 7130 ...
     $ Mean.depth.of.furrows   : num  2586 2471 3670 2350 2229 ...
     $ Mean.density.of.furrows : num  2987 1790 1901 2032 2098 ...
     $ First.direction         : num  44.9809 90.00638 89.98321 0.01527 0.00574 ...
     $ Second.direction        : num  26.5 135 63.5 116.5 135 ...
     $ Third.direction         : num  63.5 116.4 45 135 90 ...
     $ Isotropy                : num  13.5 64.5 14.9 87 86.3 ...
     $ epLsar                  : num  0.00368 0.0024 0.00301 0.00161 0.00236 ...
     $ NewEplsar               : num  0.0181 0.0177 0.0179 0.0171 0.0171 ...
     $ Asfc                    : num  12.8 6.85 12.12 5.51 5.36 ...
     $ Smfc                    : num  2.51 67.38 48.16 94.68 55.32 ...
     $ HAsfc9                  : num  0.629 0.444 0.496 0.666 0.75 ...
     $ HAsfc81                 : num  0.81 2.106 1.515 0.845 0.704 ...
     - attr(*, "comment")= Named chr [1:44] "µm" "points" "µm" "µm" ...
      ..- attr(*, "names")= chr [1:44] "Axis length - X" "Axis size - X" "Axis spacing - X" "Axis length - Y" ...

-----

# Add columns with further information

``` r
location <- substr(AvsN_imp["Location"][,1], 1, 1)
sublocation <- substr(AvsN_imp["Location"][,1], 2, 2)

AvsN_imp$Location = location
AvsN_imp$Sublocation = sublocation


location <- substr(TFE_imp["Location"][,1], 1, 1)
sublocation <- substr(TFE_imp["Location"][,1], 2, 2)

TFE_imp$Location = location
TFE_imp$Sublocation = sublocation

# adds the name of the experiment as "site"
AvsN_imp[grep("LYDIT4-", AvsN_imp[["Sample"]]), "Site"] <- "aVSn"
AvsN_imp[grep("FLT4-", AvsN_imp[["Sample"]]), "Site"] <- "aVSn"
TFE_imp[grep("LYDIT5-", TFE_imp[["Sample"]]), "Site"] <- "TFE"
TFE_imp[grep("FLT8-", TFE_imp[["Sample"]]), "Site"] <- "TFE"

AvsN_imp[["Site"]] <- factor(AvsN_imp[["Site"]])
TFE_imp[["Site"]] <- factor(TFE_imp[["Site"]])

# adds the tool type 
AvsN_imp[grep("aVSn", AvsN_imp[["Site"]]), "Tool.type"] <- "Standard sample"
TFE_imp[grep("TFE", TFE_imp[["Site"]]), "Tool.type"] <- "Standard sample"

AvsN_imp[["Tool.type"]] <- factor(AvsN_imp[["Tool.type"]])
TFE_imp[["Tool.type"]] <- factor(TFE_imp[["Tool.type"]])

# adds a column for "use-wear type" based on cycle
AvsN_imp$Usewear.type <- AvsN_imp$Cycle
TFE_imp$Usewear.type <- TFE_imp$Cycle

# adds the contact material 
Arch_imp[grep("lydite", Arch_imp[["Raw.material"]]), "Contact.material"] <- "unknown"
Arch_imp[grep("flint", Arch_imp[["Raw.material"]]), "Contact.material"] <- "unknown"

# adds the task 
Arch_imp[grep("lydite", Arch_imp[["Raw.material"]]), "Task"] <- "unknown"
Arch_imp[grep("flint", Arch_imp[["Raw.material"]]), "Task"] <- "unknown"
AvsN_imp[grep("aVSn", AvsN_imp[["Site"]]), "Task"] <- "cutting"

# adds the edge angle 
Arch_imp[grep("lydite", Arch_imp[["Raw.material"]]), "Edge.angle"] <- "unknown"
Arch_imp[grep("flint", Arch_imp[["Raw.material"]]), "Edge.angle"] <- "unknown"
AvsN_imp[grep("aVSn", AvsN_imp[["Site"]]), "Edge.angle"] <- "60°"
```

# Keeps only interesting columns and orders them

``` r
# deletes non-important columns 
AvsN_imp$Cycle <- NULL
TFE_imp$Cycle <- NULL

# orders the columns in an identical way
AvsN_imp <- AvsN_imp[c(1, 56:57, 6, 2, 55, 3:4, 58, 7, 59:60, 5, 8:54)]
TFE_imp <- TFE_imp[c(1, 58:59, 6, 2, 57, 3:4, 60,7:9, 5, 10:56)]
Arch_imp <- Arch_imp[c(1:9, 58:60, 10:57)]
```

# Merge three datasets

``` r
# check pairwise if the three lines of headers are identical among the datasets
# merges the data based on the three lines of headers while they get only 
# used in the first file 

comp <- all(sapply(list(colnames(AvsN_imp), colnames(TFE_imp)), 
                   FUN = identical, colnames(Arch_imp)))
if (comp == TRUE) {
  merged_data <- full_join(AvsN_imp, TFE_imp) %>% full_join(Arch_imp)
} else {
  stop("The headers are not identical among the datasets")
}
str(merged_data)
```

    'data.frame':   234 obs. of  60 variables:
     $ Sample                  : chr  "FLT4-12" "FLT4-12" "FLT4-12" "FLT4-12" ...
     $ Site                    : Factor w/ 5 levels "aVSn","TFE","Balve",..: 1 1 1 1 1 1 1 1 1 1 ...
     $ Tool.type               : Factor w/ 5 levels "Standard sample",..: 1 1 1 1 1 1 1 1 1 1 ...
     $ Raw.material            : Factor w/ 2 levels "flint","lydite": 1 1 1 1 1 1 1 1 1 1 ...
     $ Location                : chr  "B" "B" "B" "B" ...
     $ Sublocation             : chr  "1" "1" "1" "1" ...
     $ Area                    : chr  "01" "01" "01" "01" ...
     $ Spot                    : chr  "a" "b" "c" "a" ...
     $ Usewear.type            : chr  "before" "before" "before" "2000" ...
     $ Contact.material        : chr  "skin pad" "skin pad" "skin pad" "skin pad" ...
     $ Task                    : chr  "cutting" "cutting" "cutting" "cutting" ...
     $ Edge.angle              : chr  "60°" "60°" "60°" "60°" ...
     $ Objective               : chr  "50x095" "50x095" "50x095" "50x095" ...
     $ Analysis.date           : Date, format: "2020-08-17" "2020-08-17" ...
     $ Analysis.time           : 'times' num  14:48:58 14:49:34 14:50:09 14:50:43 14:51:18 ...
      ..- attr(*, "format")= chr "h:m:s"
     $ Acquisition.date.time   : chr  "7/20/2020 2:39:46 PM" "7/20/2020 2:55:08 PM" "7/20/2020 3:12:51 PM" "7/20/2020 3:29:51 PM" ...
     $ Axis.length.X           : num  255 255 255 255 255 ...
     $ Axis.size.X             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.X          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Y           : num  255 255 255 255 255 ...
     $ Axis.size.Y             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.Y          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Z           : num  27287 27231 26655 13395 13291 ...
     $ Axis.size.Z             : num  63694 65201 63762 65466 65538 ...
     $ Axis.spacing.Z          : num  0.428 0.418 0.418 0.205 0.203 ...
     $ NM.points.ratio.Z       : num  0 0 0 0 0 0 0 0 0 0 ...
     $ Sq                      : num  160 151 196 227 160 ...
     $ Ssk                     : num  -0.0199 4.1704 2.0253 2.2084 2.0238 ...
     $ Sku                     : num  6.21 37.01 10.42 11.22 9.9 ...
     $ Sp                      : num  1153 1693 1606 1740 1174 ...
     $ Sv                      : num  716 594 406 473 321 ...
     $ Sz                      : num  1870 2286 2013 2212 1496 ...
     $ Sa                      : num  115.8 84.7 138.7 154.4 111.9 ...
     $ Smr                     : num  12.722 0.832 1.59 1.645 10.656 ...
     $ Smc                     : num  177 111 232 250 184 ...
     $ Sxp                     : num  362 192 211 245 175 ...
     $ Sal                     : num  5.94 7.73 8.18 12.2 8.71 ...
     $ Str                     : num  0.0746 0.669 0.226 0.6994 0.1989 ...
     $ Std                     : num  170 133 50.5 101 81.5 ...
     $ Sdq                     : num  0.1019 0.0833 0.1177 0.1378 0.1048 ...
     $ Sdr                     : num  0.513 0.337 0.68 0.916 0.54 ...
     $ Vm                      : num  0.0103 0.0176 0.0206 0.0263 0.0175 ...
     $ Vv                      : num  0.187 0.128 0.252 0.276 0.202 ...
     $ Vmp                     : num  0.0103 0.0176 0.0206 0.0263 0.0175 ...
     $ Vmc                     : num  0.119 0.073 0.133 0.143 0.106 ...
     $ Vvc                     : num  0.164 0.115 0.241 0.262 0.192 ...
     $ Vvv                     : num  0.0233 0.0128 0.0112 0.0138 0.0092 ...
     $ Maximum.depth.of.furrows: num  905 865 814 881 640 ...
     $ Mean.depth.of.furrows   : num  257 174 386 409 311 ...
     $ Mean.density.of.furrows : num  3081 3318 3101 3225 3191 ...
     $ First.direction         : num  1.69e+02 1.35e+02 8.76e-03 9.00e+01 9.00e+01 ...
     $ Second.direction        : num  180 90 135 135 45 ...
     $ Third.direction         : num  135 45 117 116 135 ...
     $ Isotropy                : num  6.16 66.63 52.93 77.77 55.86 ...
     $ epLsar                  : num  0.00356 0.00393 0.00189 0.00195 0.00041 ...
     $ NewEplsar               : num  0.0187 0.0188 0.0179 0.0179 0.0175 ...
     $ Asfc                    : num  1.145 0.703 1.494 2.067 1.207 ...
     $ Smfc                    : num  3.08 3.3 2.88 2.52 2.52 ...
     $ HAsfc9                  : num  0.201 0.636 0.191 0.512 0.239 ...
     $ HAsfc81                 : num  0.264 0.939 0.388 0.722 0.386 ...

-----

# Save data

## Format name of output file

``` r
file_out <- "Use-wear_all"
```

The files will be saved as “\~/Use-wear\_all.\[ext\]”.

## Write to XLSX

``` r
write.xlsx(list(data = merged_data), 
           file = paste0(dir_out, file_out, ".xlsx"))
```

## Save R object

``` r
saveObject(merged_data, file = paste0(dir_out, file_out, ".Rbin"))
```

## Show files information

``` r
files_out <- c(paste0(dir_out, file_out, ".xlsx"), paste0(dir_out, file_out, ".Rbin"))
md5_out <- md5sum(files_out)
info_out <- data.frame(files = basename(names(md5_out)), checksum = md5_out, 
                       row.names = NULL)
```

The checksum (MD5 hashes) of the exported files are:

``` 
              files                         checksum
1 Use-wear_all.xlsx e3add56d6dcf44b8e1dc4e5bca809df1
2 Use-wear_all.Rbin 88e7180102c60afd659b1de1aab8c3ce
```

-----

# sessionInfo() and RStudio version

``` r
sessionInfo()
```

``` 
R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19041)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] tools     stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] forcats_0.5.0     stringr_1.4.0     dplyr_1.0.2       purrr_0.3.4      
 [5] readr_1.3.1       tidyr_1.1.2       tibble_3.0.3      ggplot2_3.3.2    
 [9] tidyverse_1.3.0   chron_2.3-56      R.utils_2.10.1    R.oo_1.24.0      
[13] R.methodsS3_1.8.1 openxlsx_4.1.5   

loaded via a namespace (and not attached):
 [1] tidyselect_1.1.0 xfun_0.16        haven_2.3.1      colorspace_1.4-1
 [5] vctrs_0.3.4      generics_0.0.2   htmltools_0.5.0  yaml_2.2.1      
 [9] blob_1.2.1       rlang_0.4.7      pillar_1.4.6     withr_2.2.0     
[13] glue_1.4.2       DBI_1.1.0        dbplyr_1.4.4     modelr_0.1.8    
[17] readxl_1.3.1     lifecycle_0.2.0  munsell_0.5.0    gtable_0.3.0    
[21] cellranger_1.1.0 rvest_0.3.6      zip_2.1.1        evaluate_0.14   
[25] knitr_1.29       fansi_0.4.1      broom_0.7.0      Rcpp_1.0.5      
[29] backports_1.1.9  scales_1.1.1     jsonlite_1.7.1   fs_1.5.0        
[33] hms_0.5.3        digest_0.6.25    stringi_1.5.3    rprojroot_1.3-2 
[37] grid_4.0.2       cli_2.0.2        magrittr_1.5     crayon_1.3.4    
[41] pkgconfig_2.0.3  ellipsis_0.3.1   xml2_1.3.2       reprex_0.3.0    
[45] lubridate_1.7.9  rstudioapi_0.11  assertthat_0.2.1 rmarkdown_2.3   
[49] httr_1.4.2       R6_2.4.1         compiler_4.0.2  
```

RStudio version 1.3.1073.

-----

END OF SCRIPT
